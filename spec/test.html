<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="../canny.js"></script>
    <script src="../mod/beardie.js"></script>

    <script>
        canny.add('beardieSample', (function () {
            var node,
                    data1 = {
                        name : 'beardie',
                        text : 'Dynamical included text'
                    },
                    data2 = function () {
                        return {
                            name : 'beardie'
                        };
                    },
                    data3 = function (cb) {
                         cb({
                             user : {
                                 name: 'Peter',
                                 age: 30
                             }
                         });
                    },
                    inputs = (function () {
                        var update = [];
                        return {
                            value : '',
                            notifierWhisker : function (value) {
                                update.forEach(function (fc) {
                                    fc({value: value});
                                });
                            },
                            whiskerUpdate : function (cb) {
                                update.push(cb);
                            }
                        };
                    }()),
                    triggerWhiskerUpdate = (function () {
                        var whiskerUpdate = function () {},
                                data = data2();
                        return {
                            // trigger this to update the data
                            updateData : function () {
                                whiskerUpdate(data2());
                            },
                            // part of api to whisker
                            whiskerUpdate : function (cb) {
                                whiskerUpdate = cb;
                            },
                            // object
                            name : data.name,
                            text : data.text
                        };
                    }());
            return {
                /**
                 * save it in scope BUT: if other scope is out of this scope but has the same name it should not be effected by changing this... so
                 * save also the node and parse from there.
                 *
                 * @returns {{changeData: changeData, beardiAPI: beardieAPI}}
                 */
                dynamicallyChangeData : (function () {
                    var updateBeardie;
                    return {
                        // call this to change the data and update the DOM
                        changeData : function (obj) {
                            updateBeardie('scope', obj);
                        },
                        // pass this as reference to beardie
                        beardieAPI : function (fc) {
                            updateBeardie = fc;
                            updateBeardie('scope', {
                                className : 'init',
                                text : 'initial text',
                                id : 'main'
                            });
                        }
                    }
                }()),
                sameScopeShouldNotEffected : function (fc) {
                    fc('scope', {
                        className : 'foo',
                        text : 'bar',
                        id : 'hoo'
                    });
                },
                add : function (node, attr) {}
            };
        }()));
    </script>
</head>
<body>

    <div id="dynamicallyChangeData" canny-mod="beardie" canny-var="canny.beardieSample.dynamicallyChangeData.beardieAPI">
        <div id="{{scope.id}}">
            <p class="test with {{scope.className}}"></p>
        </div>
        <p class="{{scope.className}}">the text: {{scope.text}} should be replaced correctly. Plus this text  {{scope.text}}.</p>
    </div>


    <!--<div id="supportMultipleScopes" canny-mod="beardie" canny-var="canny.beardieSample.supportScopes">-->
        <!--<div id="{{scope1.id}}" class="{{scope1.testClass}}">foo {{scope1.text}}</div>-->
        <!--<div id="{{scope2.id}}" class="{{scope2.testClass}}">foo {{scope2.text}}</div>-->
        <!--<div id="{{scope3.id}}" class="{{scope3.testClass}}">foo {{scope3.text}}</div>-->
    <!--</div>-->




</body>
</html>